### Antivirus Scanning
Usually a good first step. Antivirus software uses:
* File signatures - ex. md5 checksum
* Patteren matching analysis - heuristics
to identify malicious code.

Malware can be bypassed by antimalware by modifying it such that the signature is different, and modify the means of it to bypass the heuristics.

### Strings
To detect the strings in the malware, which may give hints as what it's doing, you can run the strings program to output all the strings of the binary.

The strings program looks for 3 or more letter long unicode strings until the null terminator (some 3 or more letter strings may be useless as the bytes maybe detected as a string).

### Packing and Obfuscation
**Obfuscation** - the process of making the code less readable or harder to reverse engineer while maintaining the same functionality.

**Packing** - Compacted malware that can not be analyzed. Packing compressed the malware such that it generates a wrapper program that can uncompress the malware using the compresion as the encryption.

Both make it harder to statically analyze the malware.

#### PE
**PE** - Portable Executable, very common executable file in Windows that begins with a header including information about the executable

PEiD - A tool to detect a packed file and the type of packer. https://www.aldeid.com/wiki/PEiD

A PE file can have a header, then sections which contatin useful information. 

* .text - The instructions for the CPU, all other sections store data and supporting information. The section is generally the only section that executes and includes code
* .rdata - stores import and export data and the read-only data
* .data - global data stored by the executable
* .rsrc - includes resources not stored in the executable such as images or strings

PEview is a useful tool to explore the sections of a PE.

Understanding what imports an executable has can give more information on what the executable is doing. 

### Linking

**Static linking** - linking libraries by basically inserting the code needed from the library into the executable

**Runtime linking** - used to link libraries at runtime, commonly used are `LoadLibrary` and `GetProcAddress` allow linking for any library on the system which means you can't see which functions are being linked to by the suspect program

**Dynamic linking** - when a library in linked, the host OS searches for the library when the program is loaded and the function is executed within the library

The PE header stores information about what libraries are linked which can give some more info.

Dependancy Walker is a program that lists only the dynamically linked functions of a file. 

Sometimes a function is imported by an ordinal which makes it harder to figure what function is being used. 

Executables can rarely export functions aswell, DLL's are created to export functions.

Hackers don't typically use the same name for the function as it is in the Microsoft Documentation which makes it harder to find the library.

PEview is a useful tool to explore a PE header. It can give the time of compilation which can be useful, but not always trustworthy.

If the virtual size data point in header is much larger than the raw size, the executable is probably packed as the .text section is larger in memory than on disk.

#### Information from a PE Header
* Imports
* Exports
* Time Date Stamps
* Sections - sections in the file, and the sizes on disk and memory
* Subsystem - Gui or Cui
* Resources - Strings, icons, menu, etc.

http://www.angusj.com/resourcehacker/ is a good tool to view the PE headers




















